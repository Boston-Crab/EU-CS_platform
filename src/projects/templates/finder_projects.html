{% load staticfiles %}
{% load countries %}
{% get_countries as countries %}
<div class="row">
	<div class="col-lg-2">
		<h3>Projects</h3>
	</div>
	<div class="col-lg-10 float-right">
		<form class="form-inline float-lg-right" id="searchProjects" action="{% url 'projects' %}">
				<!--label for="keywords" style="color:black">Keywords</label-->
				<div class="float-right">
				{% if user.is_authenticated %}
				<a class="btn btn-warning ml-2 float-right" href="{% url 'new_project' %}">
					<i class="fas fa-plus-circle"></i> Add
				</a>
				{% endif %}
			<button class="btn btn-info ml-2 float-right" id="search" type="submit" alt="Find">
					<i class="fas fa-search"></i> Find
				</button>
			<select id="country" name="country" class="custom-select form-control col-lg-2 ml-2 float-right">
					<option value="">Country<option>
					{% for country in countries %}
					<option {% if country.code ==  filters.country %} selected {% endif %} value="{{ country.code }}">{{ country.name }}</option>
					{% endfor %}
				</select>
				<select id="status" name="status" class="custom-select status-select form-control col-lg-2 ml-2 float-right">
					<option value="">Status<option>
					{% for s in status %}
					<option {% if s.id ==  filters.status %} selected {% endif %} value="{{s.id}}">
					{{s.status|capfirst}}
					</option>
					{% endfor %}
				</select>
				<select id="topic" name="topic" class="custom-select form-control col-lg-2 ml-2 float-right">
					<option value="">Topic</option>
					{% for topic in topics %}                
					<option {% if topic.topic ==  filters.topic %} selected {% endif %} value="{{topic}}">
					{{topic|capfirst}}
					</option>
					{% endfor %}
				</select>
				<input type="text" id="keywords" name="keywords" autocomplete="on" value="{{filters.keywords}}" class="basicAutoComplete form-control col-lg-2 float-right" placeholder="Keywords, project name" data-url="text_autocomplete/">
			</div>
		</form>
	</div>
<div class="col-lg-12 text-right">
{% if request.get_full_path != "/projects" %}
<a class="text-decoration-none text-muted" href="/projects"><i class="fas fa-times"></i> Clear current search query, filters, and sorts</a>
{% endif %}
</div>
</div>

<script type="text/javascript" src="{% static 'site/js/jquery.min.js' %}"></script>
<script type="text/javascript" src="{% static 'site/js/bootstrap.min.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.15.0/umd/popper.js"
integrity="sha256-7BfFV/dSvQT4pGBvRAIt6JDXsehb92DQqpGUndLCPQ4=" crossorigin="anonymous"></script>
<script
  src="https://cdn.rawgit.com/xcash/bootstrap-autocomplete/3de7ad37/dist/latest/bootstrap-autocomplete.js"></script>
<script>
  $('.basicAutoComplete').autoComplete(
    { minLength: 3 }
  );

  $("#keywords").blur(function () {
    $('#searchProjects').submit();
  });

  $(function () {
    $('#topic').on('change', function () {
      var topic = $(this).val();
      $('#searchProjects').submit();
    });
  });

  $(function () {
    $('.status-select').on('change', function () {
      var status = $(this).val();
      $('#searchProjects').submit();
    });
  });

  $(function () {
    $('#country').on('change', function () {
      var country = $(this).val();
      $('#searchProjects').submit();
    });
  });
 
  $("#host").blur(function () {
    $('#searchProjects').submit();
  });
</script>
